        if password1 == password2:
            filteruser = User.objects.filter(username=username)
            if len(filteruser) > 0:
                response=JsonResponse({'success': False, 'msg': '用户名已存在'})
                response['Access-Control-Allow-Origin'] = '*'
                return response
            else:
                User.objects.create_user(
                    username=username, password=password1, type=type,description=description)
                response=JsonResponse({'success': True})
                response['Access-Control-Allow-Origin'] = '*'
                return response
        else:
            response = JsonResponse({'success': False, 'msg': '两次密码不一致'})
            response['Access-Control-Allow-Origin'] = '*'
            return response





# 登录
class LoginView(View):
    def post(self, request, *args, **kwargs):
        username = request.POST.get('username')
        password = request.POST.get('password')
        type = request.POST.get('type')
        user = authenticate(username=username, password=password)
        if user is not None:
            if int(type) == user.type:
                login(request, user)
                return JsonResponse({'success':True})
            else:
                return JsonResponse({'success':False, 'msg': '身份不匹配'})
        else:
            response = JsonResponse({'success': False, 'msg': '用户名或密码错误'})
            # response['Access-Control-Allow-Origin'] = '*'
            return response

# 注册
class RegisterView(View):
    def post(self, request, *args, **kwargs):
        type = request.POST.get('type')
        username = request.POST.get('username')
        password1 = request.POST.get('password1')
        password2 = request.POST.get('password2')
        description = request.POST.get('description')
        if password1 == password2:
            filteruser = User.objects.filter(username=username)
            if len(filteruser) > 0:
                return JsonResponse({'success': False, 'msg': '用户名已存在'})
            else:
                User.objects.create_user(
                    username=username, password=password1, type=type,description=description)
                return JsonResponse({'success': True})
        else:
            response = JsonResponse({'success': False, 'msg': '两次密码不一致'})
            # response['Access-Control-Allow-Origin'] = '*'
            return response





urlpatterns = [
    url(r'^login/', LoginView.as_view(), name='mc_login'),
    url(r'^register/',RegisterView.as_view(),name='mc_register')
]
